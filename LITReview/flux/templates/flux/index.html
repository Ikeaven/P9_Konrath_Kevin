{% extends "flux/base_generic.html" %}


{% block content%}

<div class="container my-5">
    <div class="row">
        <div class="col-6">
            <a name="" id="" class="btn btn-primary" href={% url 'create_ticket' %} role="button">Demander une critique</a>
        </div>
        <div class="col-6 d-flex justify-content-end">
            <a name="" id="" class="btn btn-primary" href="#" role="button">Créer une critique</a>
        </div>
    </div>
</div>

<div class="container my-5">
    <div class="row">
        <div class="col-12">
            {% for ticket in tickets %}
                <div class="card mx-auto my-3">


                        {% for review in reviews %}
                            {% if ticket.id == review.ticket.id %}
                            <div class="card m-1">
                                {% comment %} <img class="card-img-top" src="holder.js/100x180/" alt=""> {% endcomment %}
                                <div class="card-body">
                                    <span>{{review.user.username}} à posté une critique :</span>
                                    <h4 class="card-title">{{review.headline}}</h4>
                                    <p class="card-text rating" hidden> {{review.rating}} </p>
                                    <p class="card-text">{{review.body}}</p>

                                </div>
                            </div>
                        {% endif %}
                    {% endfor%}

                    <div class="container px-3">
                        <div class="row">
                            <div class="col-6">
                                <div> {{ticket.user}} à demandé une critique </div>
                            </div>
                            <div class="col-6 d-flex justify-content-end">
                                <div> {{ticket.time_created}}</div>
                            </div>
                        </div>
                    </div>

                    <div class="card-body">
                        <h5 class="card-title">{{ticket.title}}</h5>
                        <p class="card-text">{{ticket.description}}</p>

                        {% if ticket.image != '' %}
                            <img src={{ticket.image.url}} alt="image" height="200px">
                        {% endif %}
                        <div class="mt-3 d-flex justify-content-end">
                            <a name="" id="" class="btn btn-primary" href="create_review/{{ticket.id}}" role="button">Créer une critique</a>
                        </div>

                    </div>
                </div>
            {% endfor %}
        </div>

    </div>
</div>


{% load static %}
<script type="text/javascript" src="{% static 'flux/rating_star.js'%}"></script>

{% endblock %}